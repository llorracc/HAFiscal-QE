# Sources for `Comparison_Splurge_Table.tex`

## Overview

The table `Comparison_Splurge_Table.tex` is generated by **`Code/HA-Models/Target_AggMPCX_LiquWealth/Estimation_BetaNablaSplurge.py`** at **line 667**.

This table compares marginal propensities to consume (MPCs) across wealth quartiles for three cases:

1. Model with splurge parameter (Splurge ≥ 0)
2. Model without splurge parameter (Splurge = 0)
3. Empirical data targets

## Data Sources

### Row 1: "Splurge ≥ 0" (Baseline Model)

- **Source**: Estimated model parameters from `Result_AllTarget.txt` (line 590-591)
- **Generated by**: Optimization routine `find_Opt()` (line 546) that estimates `[splurge, beta, nabla]` parameters
- **Model simulation**: `FagerengObjFunc()` with estimated parameters produces:
  - `simulated_MPC_means_smoothed[3,2,1,0]` → MPCs by wealth quartile (1st-4th WQ)
  - `simulated_MPC_mean_add_Lottery_Bin[0]` → Aggregate MPC
  - `KY_Model` → Capital-to-income ratio

**Code reference** (lines 655-657):

```python
output +="Splurge $\geq$ 0 &"+mystr2(SplurgeNot0_Sol['simulated_MPC_means_smoothed'][3])      + " & "+ mystr2(SplurgeNot0_Sol['simulated_MPC_means_smoothed'][2])+ " & "+  \
                            mystr2(SplurgeNot0_Sol['simulated_MPC_means_smoothed'][1])      + " & "+ mystr2(SplurgeNot0_Sol['simulated_MPC_means_smoothed'][0]) + " & "+  \
                            mystr2(SplurgeNot0_Sol['simulated_MPC_mean_add_Lottery_Bin'][0])+ " & "+ mystr2(SplurgeNot0_Sol['KY_Model'])  + " \\\\ \n"
```

### Row 2: "Splurge = 0" (Robustness Check)

- **Source**: Estimated model parameters from `Result_AllTarget_Splurge0.txt` (line 586-587)
- **Generated by**: Optimization routine `find_Opt_splurge0()` (line 577) with splurge constrained to 0
- **Model simulation**: Same structure as baseline but without splurge parameter

**Code reference** (lines 658-660):

```python
output +="Splurge = 0 &"+   mystr2(Splurge0_Sol['simulated_MPC_means_smoothed'][3])         + " & "+ mystr2(Splurge0_Sol['simulated_MPC_means_smoothed'][2])+ " & "+  \
                            mystr2(Splurge0_Sol['simulated_MPC_means_smoothed'][1])         + " & "+ mystr2(Splurge0_Sol['simulated_MPC_means_smoothed'][0]) + " & "+  \
                            mystr2(Splurge0_Sol['simulated_MPC_mean_add_Lottery_Bin'][0])   + " & "+ mystr2(Splurge0_Sol['KY_Model'])  + " \\\\ \n"
```

### Row 3: "Data" (Empirical Targets)

#### MPC by Wealth Quartile

- **Variable**: `MPC_target[2,:]` (lines 80, 661-662)
- **Original source**: Fagereng, Holm, and Natvik (2021) Table 9
- **Description**: Norwegian lottery winner data, 3rd lottery quartile
- **Base values**: `[0.663, 0.546, 0.390, 0.386]` (lines 76-79)
- **Adjustment**: Multiplied by `AdjFactor` (=1.0, line 37, 80)
- **Final values**: `[0.39, 0.39, 0.55, 0.66]` (note: values shown are for 4th, 3rd, 2nd, 1st WQ respectively in code)

#### Aggregate MPC

- **Variable**: `Agg_MPCX_target[0]` (line 83, 663)
- **Original source**: Fagereng, Holm, and Natvik (2021) Figure 2
- **Description**: Same-year consumption response to lottery win
- **Value**: `0.5056845`

#### Capital-to-Income Ratio (K/Y)

- **Variable**: `KY_target` (lines 94, 663)
- **Original source**: US empirical capital-to-income ratio
- **Value**: `6.60`

**Code reference** (lines 661-663):

```python
output +="Data &"+          mystr2(MPC_target[2,3])                                         + " & "+ mystr2(MPC_target[2,2])+ " & "+  \
                            mystr2(MPC_target[2,1])                                         + " & "+ mystr2(MPC_target[2,0]) + " & "+  \
                            mystr2(Agg_MPCX_target[0])                                      + " & "+ mystr2(KY_target)  + " \\\\ \\bottomrule \n"
```

## Computational Pipeline

```
Empirical Targets                           
(Fagereng et al + US data)                  
         │                                  
         ├─────────────┬─────────────────┐
         ▼             ▼                 ▼
   Optimization:  Optimization:     Direct
   find_Opt()    find_Opt_splurge0() Use
         │             │                 │
         ▼             ▼                 │
Result_AllTarget  Result_AllTarget       │
    .txt           _Splurge0.txt         │
[splurge,β,∇]    [β,∇]                  │
         │             │                 │
         ▼             ▼                 │
FagerengObjFunc  FagerengObjFunc         │
   Simulation     Simulation             │
  (with splurge) (splurge=0)             │
         │             │                 │
         └─────────────┴─────────────────┘
                       ▼
         Comparison_Splurge_Table.tex
                  (line 667)
```

## Estimation Targets

The optimization routines target multiple objectives simultaneously (line 584):

- `'AGG_MPC_plus_Liqu_Wealth_plusKY_plusMPC'`

This includes:

1. **Aggregate MPC over time** (5 periods): From Fagereng et al. Figure 2
2. **Liquid wealth distribution** (Lorenz curve): US data, 4 quintile points
3. **Capital-to-income ratio**: US K/Y = 6.60
4. **MPCs by wealth quartile**: From Fagereng et al. Table 9

## Key Finding

The table demonstrates that **without the splurge parameter, the model misses the 1st wealth quartile MPC by 26 percentage points** (0.13 vs 0.39 in data), even though:

- Aggregate MPC is similar (0.49 vs 0.51)
- K/Y ratio matches (6.58 vs 6.60)

This shows the splurge parameter is necessary for matching microeconomic consumption dynamics across the wealth distribution, though it does not substantially affect policy rankings (as noted in the table's footnote).

## Parameters Used

From `Estimation_BetaNablaSplurge.py` (lines 56-69):

**Norwegian Calibration** (`Parametrization = 'NOR'`):

- Survival probability: `LivPrb = 1 - 1/160`
- Risk-free rate: `Rfree = 1.02^0.25` (quarterly)
- Borrowing rate: `Rboro = 1.137^0.25`
- Unemployment probability: `UnempPrb = 0.044`
- Unemployment income: `IncUnemp = 0.60`
- Permanent shock std: `PermShkStd = 0.001^0.5`
- Transitory shock std: `TranShkStd = 0.132^0.5`
- Borrowing constraint: `BoroCnstArt = 0`
- Income growth: `PermGroFacAgg = 1.01^0.25`
- CRRA: `CRRA = 2.0`

## Related Files

- **Generated table**: `Figures/Comparison_Splurge_Table.tex`
- **LaTeX source**: `Tables/Comparison_Splurge_Table.tex` (wrapper with formatting/caption)
- **Estimation script**: `Code/HA-Models/Target_AggMPCX_LiquWealth/Estimation_BetaNablaSplurge.py`
- **Parameter file**: `Code/HA-Models/Target_AggMPCX_LiquWealth/SetupParamsCSTW.py`
- **Results with splurge**: `Code/HA-Models/Target_AggMPCX_LiquWealth/Result_AllTarget.txt`
- **Results without splurge**: `Code/HA-Models/Target_AggMPCX_LiquWealth/Result_AllTarget_Splurge0.txt`

## References

- Fagereng, Andreas, Martin B. Holm, and Gisle J. Natvik (2021). "MPC Heterogeneity and Household Balance Sheets." *American Economic Journal: Macroeconomics*, 13(4): 1-54.
- US liquid wealth distribution and K/Y ratio: Standard macroeconomic data sources
